{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# IMPORT PACKAGES\n",
    "from sklearn.neighbors import KDTree\n",
    "import numpy as np\n",
    "import scipy\n",
    "import matplotlib.pyplot as plt\n",
    "import time\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# QUESTION 1: Functions\n",
    "\n",
    "# Cross validation function\n",
    "# INPUT: All datasets (NxD np.arrays (X), Nx1 np.arrays (Y)), k (int), # partitions (int), whether to plot prediction curves (bool)\n",
    "# OUTPUT: Loss for L1, L2 (floats)\n",
    "def cross_validation_k(x_train, y_train, x_valid, y_valid, k, partitions=5, plot=False):\n",
    "    start = time.time()\n",
    "    \n",
    "    # Combine train and validation sets\n",
    "    x_cross = np.vstack([x_valid,x_train])\n",
    "    y_cross = np.vstack([y_valid,y_train])\n",
    "    \n",
    "    # Create partitions of indices\n",
    "    indices = np.arange((x_cross.shape[0]))\n",
    "    np.random.shuffle(indices)\n",
    "    part = np.array_split(indices, partitions)\n",
    "    \n",
    "    avg_predictions_l1 = np.zeros((x_cross.shape[0],1))\n",
    "    avg_predictions_l2 = np.zeros((x_cross.shape[0],1))\n",
    "    \n",
    "    for i in range(len(part)):\n",
    "        # Find indices for holdout, training\n",
    "        holdout = part[i]\n",
    "        train = np.array([])\n",
    "        \n",
    "        for j in range(len(part)):\n",
    "            if j==i:\n",
    "                continue\n",
    "            else:\n",
    "                train = np.append(train,np.array(part[j]))\n",
    "        train = train.astype(int)\n",
    "        \n",
    "        x_nhold = x_cross[train] # Neighbours: X-values with known Y\n",
    "        y_nhold = y_cross[train] # Neighbours: Known Y\n",
    "        x_hold = x_cross[holdout] # Test points: \"Unknown\" Y\n",
    "        y_hold = y_cross[holdout] # Test points: Y for testing\n",
    "            \n",
    "        # Find k-NN generated values for all x_cross in holdout\n",
    "        y_knn_l1 = np.array([[]])\n",
    "        y_knn_l2 = np.array([[]])\n",
    "        \n",
    "        for x_val in x_hold:\n",
    "            y_knn_l1 = np.append(y_knn_l1, knn_regression_l1(x_nhold, y_nhold, x_val, k))\n",
    "            y_knn_l2 = np.append(y_knn_l2, knn_regression_l2(x_nhold, y_nhold, x_val, k))\n",
    "        \n",
    "        y_knn_l1 = np.c_[y_knn_l1]\n",
    "        y_knn_l2 = np.c_[y_knn_l2]\n",
    "        \n",
    "        for val in range(y_knn_l1.shape[0]):\n",
    "            avg_predictions_l1[holdout[val],0] = y_knn_l1[val]\n",
    "            avg_predictions_l2[holdout[val],0] = y_knn_l2[val]\n",
    "        \n",
    "    # After running through the whole fold, find the average losses:\n",
    "    avgloss_l1 = RMSEloss(y_cross,avg_predictions_l1)\n",
    "    avgloss_l2 = RMSEloss(y_cross,avg_predictions_l2)\n",
    "\n",
    "    if plot==True:\n",
    "        fig, ax = plt.subplots(1)\n",
    "        ax.plot(x_cross,y_cross)\n",
    "        ax.set_title('Actual Cross-Validation Curve'.format(k))\n",
    "        ax.set_xlabel('Time')\n",
    "        ax.set_ylabel('CO2 Levels')\n",
    "        plt.show()        \n",
    "        \n",
    "        fig, ax = plt.subplots(1)\n",
    "        ax.plot(x_cross,avg_predictions_l2)\n",
    "        ax.set_title('Cross-Validation Prediction Curve for L2, K = {}'.format(k))\n",
    "        ax.set_xlabel('Time')\n",
    "        ax.set_ylabel('CO2 Levels')\n",
    "        plt.show()\n",
    "        \n",
    "    print(\"CV | K-Value: {} | Average loss for L1: {} | Average loss for L2: {} | Time = {}s\".format(k,avgloss_l1,avgloss_l2,(time.time()-start)))\n",
    "    return avgloss_l1, avgloss_l2\n",
    "      \n",
    "# Test function\n",
    "# INPUT: All datasets (NxD np.arrays (X), Nx1 np.arrays (Y)), k (int), whether to plot prediction curves (bool)\n",
    "# OUTPUT: Loss for L1, L2 (floats)\n",
    "def test_k(x_train, y_train, x_valid, y_valid, x_test, y_test, k, plot=False):\n",
    "    start = time.time()\n",
    "    \n",
    "    x_nns = np.vstack([x_valid,x_train])\n",
    "    y_nns = np.vstack([y_valid,y_train])\n",
    "    \n",
    "    y_knn_l1_test = np.array([[]])\n",
    "    y_knn_l2_test = np.array([[]])\n",
    "    \n",
    "    for ind in x_test:       \n",
    "        y_knn_l1_test = np.append(y_knn_l1_test, knn_regression_l1(x_nns, y_nns, ind, k))\n",
    "        y_knn_l2_test = np.append(y_knn_l2_test, knn_regression_l2(x_nns, y_nns, ind, k))\n",
    "    \n",
    "    y_knn_l1_test = np.c_[y_knn_l1_test]\n",
    "    y_knn_l2_test = np.c_[y_knn_l2_test]\n",
    "    \n",
    "    if plot==True:\n",
    "        fig, ax = plt.subplots(1)\n",
    "        ax.plot(x_test,y_test)\n",
    "        ax.set_title('Actual Test Curve'.format(k))\n",
    "        ax.set_xlabel('Time')\n",
    "        ax.set_ylabel('CO2 Levels')\n",
    "        plt.show() \n",
    "        \n",
    "        fig, ax = plt.subplots(1)\n",
    "        ax.plot(x_test,y_knn_l2_test)\n",
    "        ax.set_title('Test Prediction Curve for L2, K = {}'.format(k))\n",
    "        ax.set_xlabel('Time')\n",
    "        ax.set_ylabel('CO2 Levels')\n",
    "        plt.show()\n",
    "    \n",
    "    testloss_l1 = RMSEloss(y_test,y_knn_l1_test)\n",
    "    testloss_l2 = RMSEloss(y_test,y_knn_l2_test)\n",
    "    \n",
    "    print(\"Test | K-Value: {} | Average loss for L1: {} | Average loss for L2: {} | Time = {}s\".format(k,testloss_l1,testloss_l2,(time.time()-start)))\n",
    "    return testloss_l1, testloss_l2\n",
    "\n",
    "# Euclidean (2-norm) regression\n",
    "# INPUT: X and Y training datasets (NxD np.array (X), Nx1 np.array (Y)), test point x_test[i] (1xD np.array), k (int)\n",
    "# OUTPUT: Prediction for y_test[i] (1x1 np.array)\n",
    "def knn_regression_l1(x_train, y_train, x_test, k):\n",
    "    # 2-NORM: Euclidean Distance\n",
    "    # Get indices of k nearest neighbors\n",
    "    dist = np.sqrt(np.sum(np.square(x_train-x_test), axis=1))\n",
    "    i_nn = np.argpartition(dist, kth=k)[:k]\n",
    "    \n",
    "    # Take the average of points in the partition\n",
    "    test_val = np.average(y_train[i_nn])\n",
    "    \n",
    "    return test_val\n",
    "\n",
    "# Manhattan (1-norm) regression\n",
    "# INPUT: X and Y training datasets (NxD np.array (X), Nx1 np.array (Y)), test point x_test[i] (1xD np.array), k (int)\n",
    "# OUTPUT: Prediction for y_test[i] (1x1 np.array)\n",
    "def knn_regression_l2(x_train, y_train, x_test, k): \n",
    "    # 1-NORM: Manhattan Distance\n",
    "    # Get indices of k nearest neighbors\n",
    "    dist = (np.sum(abs(x_train-x_test), axis=1))\n",
    "    i_nn = np.argpartition(dist, kth=k)[:k]\n",
    "    \n",
    "    # Take the average of points in the partition\n",
    "    test_val = np.average(y_train[i_nn])\n",
    "    return test_val\n",
    "\n",
    "# RMSE Loss Function\n",
    "# INPUT: Predicted Y array, actual Y array (Nx1 np.arrays)\n",
    "# OUTPUT: Loss (float)\n",
    "def RMSEloss(y_real,y_pred):\n",
    "    return np.sqrt(np.mean((y_pred-y_real)**2))\n",
    "\n",
    "\n",
    "# Plot Loss Curve\n",
    "# INPUT: All datasets (NxD np.arrays (X), Nx1 np.arrays (Y)), whether to plot cross validation (True) or test curve (bool)\n",
    "# OUTPUT: None (plots are printed)\n",
    "def plot_loss(x_train, y_train, x_valid, y_valid, x_test, y_test, cv=True):\n",
    "    if cv==True:\n",
    "        x_axes = np.arange(1,30)\n",
    "        y_axes_l1 = np.array([])\n",
    "        y_axes_l2 = np.array([])\n",
    "        for k in range(1,30):\n",
    "            loss1, loss2 = cross_validation_k(x_train, y_train, x_valid, y_valid, k, partitions=5, plot=False)\n",
    "            y_axes_l1 = np.append(y_axes_l1,loss1)\n",
    "            y_axes_l2 = np.append(y_axes_l2,loss2)\n",
    "        fig, axs = plt.subplots(2,sharex=True)\n",
    "        axs[0].plot(x_axes,y_axes_l1)\n",
    "        axs[0].set_title('Cross Validation Loss for Distance Metric L1 (top) and L2 (bottom) over K')\n",
    "        axs[0].set_xlabel('RMSE Loss')\n",
    "        axs[1].plot(x_axes,y_axes_l2)\n",
    "        axs[0].set_xlabel('K Value')\n",
    "        axs[0].set_xlabel('RMSE Loss')\n",
    "        plt.show()\n",
    "    else:\n",
    "        x_axes = np.arange(10,15)\n",
    "        y_axes_l1 = np.array([])\n",
    "        y_axes_l2 = np.array([])\n",
    "        for k in range(10,15):\n",
    "            loss1, loss2 = test_k(x_train, y_train, x_valid, y_valid, x_test, y_test, k, plot=False)\n",
    "            y_axes_l1 = np.append(y_axes_l1,loss1)\n",
    "            y_axes_l2 = np.append(y_axes_l2,loss2)    \n",
    "        fig, axs = plt.subplots(2,sharex=True)\n",
    "        axs[0].plot(x_axes,y_axes_l1)\n",
    "        axs[0].set_title('Test Loss for Distance Metric L1 over K')\n",
    "        axs[0].set_xlabel('K Value')\n",
    "        axs[0].set_ylabel('RMSE Loss')\n",
    "        axs[1].plot(x_axes,y_axes_l2)\n",
    "        axs[1].set_title('Cross Validation Loss for Distance Metric L2 over K')\n",
    "        axs[0].set_xlabel('K Value')\n",
    "        axs[0].set_ylabel('RMSE Loss')\n",
    "        plt.show()   "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Working with 'mauna_loa'...\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Test | K-Value: 4 | Average loss for L1: 0.4027682877240139 | Average loss for L2: 0.4027682877240139 | Time = 0.8794019222259521s\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "(0.4027682877240139, 0.4027682877240139)"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# QUESTION 1: Main\n",
    "from data_utils import load_dataset\n",
    "\n",
    "# 1. Uncomment the dataset you'd like to work with.\n",
    "\n",
    "print(\"Working with 'mauna_loa'...\")\n",
    "x_train, x_valid, x_test, y_train, y_valid, y_test = load_dataset('mauna_loa')\n",
    "\n",
    "#print(\"Working with 'rosenbrock'...\")\n",
    "#x_train, x_valid, x_test, y_train, y_valid, y_test = load_dataset('rosenbrock', n_train=1000, d=2)\n",
    "\n",
    "#print(\"Working with 'pumadyn32nm'...\")\n",
    "#x_train, x_valid, x_test, y_train, y_valid, y_test = load_dataset('pumadyn32nm')\n",
    "\n",
    "# 2. Iterating over k to find the k estimate: \n",
    "\n",
    "for k in range(1,30):\n",
    "    cross_validation_k(x_train, y_train, x_valid, y_valid, 28, partitions=5, plot=False)\n",
    "    test_k(x_train, y_train, x_valid, y_valid, x_test, y_test, 4, plot=False)\n",
    "\n",
    "# 3. Uncomment to retrieve loss plot.\n",
    "\n",
    "#plot_loss(x_train, y_train, x_valid, y_valid, x_test, y_test, cv=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# QUESTION 2: Functions\n",
    "\n",
    "# KD Tree Regression Function\n",
    "# INPUT: All datasets (NxD np.arrays (X), Nx1 np.arrays (Y)), k value (int)\n",
    "# OUTPUT: Test loss (float)\n",
    "def knn_kdtree_regression(x_train, y_train, x_valid, y_valid, x_test, y_test, k_val):\n",
    "    start = time.time()\n",
    "    \n",
    "    x_cross = np.vstack([x_valid,x_train])\n",
    "    y_cross = np.vstack([y_valid,y_train])\n",
    "    \n",
    "    # Set up trees for train, valid, and test sets:\n",
    "    tree_neighbours = KDTree(x_cross)\n",
    "    pred_test = np.zeros((x_test.shape[0],1))\n",
    "    \n",
    "    # Find loss for nearest neighbours:\n",
    "    nearest_dist_test, nearest_ind_test = tree_neighbours.query(x_test, k=k_val)\n",
    "    \n",
    "    it = 0 \n",
    "    \n",
    "    for inds in nearest_ind_test:\n",
    "        pred_test[it,0] = np.average(y_cross[inds])\n",
    "        it+=1\n",
    "        \n",
    "    test_loss = RMSEloss(y_test,pred_test)\n",
    "    \n",
    "    # Print results\n",
    "    print(\" K-Value: {} | Average loss for test: {} | Time = {}s\".format(k_val,test_loss,(time.time()-start)))\n",
    "    \n",
    "    # Return loss values\n",
    "    return test_loss\n",
    "\n",
    "# RMSE Loss Function\n",
    "# INPUT: Predicted Y array, actual Y array (NxD np.arrays)\n",
    "# OUTPUT: Loss (float)\n",
    "def RMSEloss(y_real,y_pred):\n",
    "    return np.sqrt(np.mean((y_pred-y_real)**2))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Working with 'rosenbrock'...\n",
      "Iteration 0\n",
      " K-Value: 5 | Average loss for test: 0.26680576927423627 | Time = 0.046892642974853516s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.2783462791791558 | Average loss for L2: 1.28664643309996 | Time = 1.2242040634155273s\n",
      "Iteration 1\n",
      " K-Value: 5 | Average loss for test: 0.3790673006255698 | Time = 0.05241823196411133s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.2255184754569064 | Average loss for L2: 1.2289851481022316 | Time = 1.1695575714111328s\n",
      "Iteration 2\n",
      " K-Value: 5 | Average loss for test: 0.4195481631141861 | Time = 0.0564579963684082s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.2251100704678861 | Average loss for L2: 1.2168674092717868 | Time = 1.2012572288513184s\n",
      "Iteration 3\n",
      " K-Value: 5 | Average loss for test: 0.5208687829091821 | Time = 0.08298802375793457s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.176986605730216 | Average loss for L2: 1.166584217338423 | Time = 1.3171355724334717s\n",
      "Iteration 4\n",
      " K-Value: 5 | Average loss for test: 0.6114880533140192 | Time = 0.1315016746520996s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.1580022478568335 | Average loss for L2: 1.144439692975329 | Time = 1.205132246017456s\n",
      "Iteration 5\n",
      " K-Value: 5 | Average loss for test: 0.6894160685241714 | Time = 0.16483592987060547s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.1369917944405554 | Average loss for L2: 1.1304941166346343 | Time = 1.3078744411468506s\n",
      "Iteration 6\n",
      " K-Value: 5 | Average loss for test: 0.7468695664130561 | Time = 0.21275663375854492s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.1415103966785802 | Average loss for L2: 1.137295724415541 | Time = 1.356987476348877s\n",
      "Iteration 7\n",
      " K-Value: 5 | Average loss for test: 0.8003148666715438 | Time = 0.26542019844055176s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.1398263515638933 | Average loss for L2: 1.1351793639014107 | Time = 1.4386835098266602s\n",
      "Iteration 8\n",
      " K-Value: 5 | Average loss for test: 0.8383195931730975 | Time = 0.310833215713501s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.147768161111644 | Average loss for L2: 1.1466759316246045 | Time = 1.4181654453277588s\n",
      "Iteration 9\n",
      " K-Value: 5 | Average loss for test: 0.8824858097024124 | Time = 0.39327478408813477s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.1461132563432022 | Average loss for L2: 1.1497492303166672 | Time = 1.5074455738067627s\n",
      "Iteration 10\n",
      " K-Value: 5 | Average loss for test: 0.8909326972909707 | Time = 0.4369213581085205s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.1568699504335667 | Average loss for L2: 1.1566349200506367 | Time = 1.488041877746582s\n",
      "Iteration 11\n",
      " K-Value: 5 | Average loss for test: 0.9409157428389912 | Time = 0.4820873737335205s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.1649702715055823 | Average loss for L2: 1.1663888398489874 | Time = 1.5689828395843506s\n",
      "Iteration 12\n",
      " K-Value: 5 | Average loss for test: 0.9431646647857141 | Time = 0.5107729434967041s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.1759071831663221 | Average loss for L2: 1.1776405116203374 | Time = 4.682387351989746s\n",
      "Iteration 13\n",
      " K-Value: 5 | Average loss for test: 0.9641934356018512 | Time = 0.5952072143554688s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.1902834776611717 | Average loss for L2: 1.1905878801714105 | Time = 4.708485841751099s\n",
      "Iteration 14\n",
      " K-Value: 5 | Average loss for test: 0.9984543800751491 | Time = 0.5775482654571533s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.1942274508980069 | Average loss for L2: 1.1890657345272018 | Time = 1.716306209564209s\n",
      "Iteration 15\n",
      " K-Value: 5 | Average loss for test: 1.0233264609536443 | Time = 0.6475284099578857s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.2027338863569148 | Average loss for L2: 1.2029071525353177 | Time = 5.677279233932495s\n",
      "Iteration 16\n",
      " K-Value: 5 | Average loss for test: 1.0213714391362614 | Time = 0.7585859298706055s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.2044114035339932 | Average loss for L2: 1.2031821381789143 | Time = 5.759375810623169s\n",
      "Iteration 17\n",
      " K-Value: 5 | Average loss for test: 1.0573100114620613 | Time = 0.6997606754302979s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.2237974193726633 | Average loss for L2: 1.2158177647557178 | Time = 6.003629446029663s\n",
      "Iteration 18\n",
      " K-Value: 5 | Average loss for test: 1.0785168252217128 | Time = 0.6724095344543457s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.228688722966364 | Average loss for L2: 1.2255038485039578 | Time = 2.0742404460906982s\n",
      "Iteration 19\n",
      " K-Value: 5 | Average loss for test: 1.0829342456224056 | Time = 0.6905312538146973s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.2413250079637146 | Average loss for L2: 1.2387223203816287 | Time = 6.672465562820435s\n",
      "Iteration 20\n",
      " K-Value: 5 | Average loss for test: 1.0894476586929678 | Time = 0.7058548927307129s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.2449393236822426 | Average loss for L2: 1.241306443336293 | Time = 7.292027950286865s\n",
      "Iteration 21\n",
      " K-Value: 5 | Average loss for test: 1.1196573457120944 | Time = 0.7266647815704346s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.2599252863899117 | Average loss for L2: 1.2493873010535939 | Time = 7.310150146484375s\n",
      "Iteration 22\n",
      " K-Value: 5 | Average loss for test: 1.1098577886375371 | Time = 0.7677097320556641s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.267174872178801 | Average loss for L2: 1.2593253086615812 | Time = 7.404700756072998s\n",
      "Iteration 23\n",
      " K-Value: 5 | Average loss for test: 1.126001454701541 | Time = 0.7662010192871094s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.2622206654589023 | Average loss for L2: 1.2567170546807143 | Time = 7.723363161087036s\n",
      "Iteration 24\n",
      " K-Value: 5 | Average loss for test: 1.141889458141979 | Time = 0.9123198986053467s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.2766999556359857 | Average loss for L2: 1.272046815965401 | Time = 7.994707822799683s\n",
      "Iteration 25\n",
      " K-Value: 5 | Average loss for test: 1.1558267725335885 | Time = 0.7956457138061523s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.2844065381394043 | Average loss for L2: 1.2864497581111982 | Time = 8.256181716918945s\n",
      "Iteration 26\n",
      " K-Value: 5 | Average loss for test: 1.1662979246619825 | Time = 0.8202402591705322s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.301802452533598 | Average loss for L2: 1.2944232794228683 | Time = 9.634021997451782s\n",
      "Iteration 27\n",
      " K-Value: 5 | Average loss for test: 1.1667961990387867 | Time = 1.1383745670318604s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.3022427944983692 | Average loss for L2: 1.290497242911689 | Time = 9.615947723388672s\n",
      "Iteration 28\n",
      " K-Value: 5 | Average loss for test: 1.1618708827724689 | Time = 0.8954002857208252s\n",
      "Test | K-Value: 5 | Average loss for L1: 1.2983785437703697 | Average loss for L2: 1.2966234416202564 | Time = 9.039536952972412s\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAecAAAEWCAYAAABcw1/oAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAgAElEQVR4nOzdeXxU1d348c83OwkEAiRsAQLIIhA2A7iCWtxtxbqAohW0rs+vdalttX0q1KVa9anV2udx1yoWcMN9oSqCVkSiQtllCyQRyELIvs/5/XHuDJNhsk8ymeT7fr3mNTN3PffOnfu959xzzxFjDEoppZTqOMKCnQCllFJK1aXBWSmllOpgNDgrpZRSHYwGZ6WUUqqD0eCslFJKdTAanJVSSqkOplXBWUR+JyLPBCox7UVEuonIOyJSKCKvBjs9HYGI3CgiB0WkRET6BDs9oUREbhCRj4OdDhV8IvKViFwR7HQ0RESWish/BzsdoUxEZonIhrZcR4PB2TlRu18uESn3+j7PGPMnY8zP2zKBTjpSRMR4rTtDRO5oxSIvBvoBfYwxlwQomSFLRCKBvwBnGmO6G2Pyfca793+E811E5G8isk1EBonIfBGp9fp99ojI8yIyqoF1bveavlZEKry+/6Ztt7j9iMgYn2P3gIg8KiLhrVjm2SKys5Xzu3z+3x3iItW50DEi8pNgp6WjEpEH2itT5BwrRkT+x2d4uojMdT67f7Nf+EyTJyLH17PcpSJS6Rx7h0TkQxE5pu22JLCMMR8bYya25ToaDM7Oibq7MaY7sA/4sdewl9syYfXo5aTlMuAuETm7uQtwTopDge+NMTUtmD+iufOEgH5ADLC5sQlFRIAngVOBmcaYbGfUGue36QnMAsqBb0RkvL/lGGNGex1ba4AbvI6tB/2sN5T3e63Xtk7G7p9r/U3Yjtu52/v/3ZKL1DZK61XAIee9TYT4sRQMRcC1IjKogWkOAb8XkdhmLPce5z+RDBRgzysBF6q/d2uLtReJyGLnszt3tUBEMkWkwLmimioi/xGRwyLyuM/8V4vIVmfaj0RkaFPWa4xZgw0k453ljBGRfzlXYNtF5FKvdbwgIv8nIu+LSCmwGrgLmONctV0jImEi8t8isldEckTkRRHp6bNd14jIPuDT5m6riIwQkU9FJN+5mnxZRHp5jc8QkdudeQtFZJmIxHiNv0BE1otIkYjscl+UiEhPEXlWRPaLSLaI3FtfjkxEokXkryLyg/P6qzNsFLDdmeywiHzawK4PB14A0oBTjTEH/fw2tcaYXcaYm4BVwKIGllcvZ39+KiJ/F5EC4A5n+PXOb3xIRN7zPmGIyHhnngLnuJrdwPKvF5vzLxaRnSJytde4s51hvxORXGffzvMan+QcT0UisgZ7sdckxpj9wCfAWK/lHXB+/81AkYjEOMdXstc0S51jtA+wHBguR3K9fUQkXET+ICK7/R1jTSX2ls/fnWMqS0QeEluy4r1f/iAiB4H/c4Zf4hy7RSKyQ0R+5Azv7fyXDjj/k4UiUu85xzkWpwPXA+eLSG+vce51/9H57XeLyCVe45eKLc1Z6fymn7iPDa/9eaOI7AI2OcNnisi3zn/uKxGZ6rW8eo+PhrbZMcJZXpFznCR4zXeKiKwVe474VkRO8hp3rdhzQbHv9nlNMxu4DbjK+e2/doYPcdZ1SES+F5EmXdyIPYd8ISIPNTBZLrAMaKgo/DtgI/CLBqbxyxhTBrwKTPJJW0P/9fOc/X5Y7LnMcztBmnnucP47jzv/9UIR2SAio51xF3gdB5ki8ktneJ3SKxFJFZHPnfT8R0TO8Rq31EnjR85y/i1NiXXGmCa9gAxgls+wRcBi53MKYIAnsLmwM4EK4E0gCRgE5GBzWwCzgZ3AsUAE9of/sp51u5cdAQhwElAG/AiIAzKBBc74KUAeMM6Z9wWg0JknzEmbJ93ONFc7aRkOdAfeAF7yWfeLzrq6tWBbjwHOAKKBROwFwl999u3XwECgN7AVm5MEmOak/wwn/YOAMc64N7FXm3HOer8Grq9nH94NfOVMlwh8ib1yrbN/G9n/rwFrsSUY3uPnA1/4me9q4GATjq0vgPk+w24AarA5zHBnv8919s0oIBK4F1jpTB8P7AfmOdNPxV7NH1PPOn8CDHOOJ3dO333MnA1UA7931nMhUAx099rvi500TQIOAh/Xs54xQI3X92RnGy73GnYAWOf8/t2cY8oAyV7TLAX+2yt9O33WcwfwubOMGOxx/3w9aTpqfq9xDzrL6YstUVkH/N5rvhrnWIpy0noKNtdzGvb4HAKMcqb/APgbEAsMwJ7Ar2rgOLgPWO18/h64ySfNNcD9zrpnYc8Bw7z2z2HgBGf7n3D/Jl778z2gl5PuJGyO8FLseWM+Ngj1bMLx0dA2f4W92B2B/V9+CSzy+h/lO8sLA8511pngvA4DI5xpBwHH1rOfHgCe8Rm2FngEe45Jwx77J9Uz/1Ls+TbJ+U3+u4Hf5GzsuXEw9j/g3t/pwFyv/+rH2AurfCDeGZ4HHN9QGpzPPYBXgLVe4xv6r/cHSoDznXG/wf5fr2jhueMCbOldvPO7jAOSnHH5wDTncx9gsu9/CHt87QV+5Sz7LCd93sdmDjY2RWLPoy80el5sbAKvnZVB04LzIK/x+cAcr++vA7d4/XGv8RoXhv2zDfWzbveyD2P/FFuBXzrj5gCf+0z/JLDQ+fwC8GJ96Xa+f0LdE8Fo58eO8Fr3cD/padK2+tme2cB3Pvv2Cp8T5BNe2/KIn2X0AyqBbl7DLnMfcH6m3wWc6/X9LCDDZ3saC85FwK/8jJ+P/+B8NlDdhGOrvuD8vc+wlcA8r++Rzu/UD1sM+i+f6f8B/LaJx/eHOBc2TroLgTCv8UXYQBwDuIAUr3F/oeHg7D52DzufPwPivKY5QN1g3ZLgvAevkzE2sJQBUs/vUuuVpsPAT5xx2cDpXtNeAGzzmq8UiPTZx/f7WcdQP9MuAD6oZz+FYW+duS9K/0jdk/XZ2AvgGK9hbwO/9to/L3iN6+3sw0Sv/Xmi1/hrcS4EvIZ9hxNwGjk+/G6zM+4r4Hav77cBbzqfFwJP+0y/CnsOcwfnC7y3sZ511AnOwEhn33ifCx7BOYf4mX8p9rziOY82sC7vIPQY8A/n81HB2es3+aPzubHgXM6R/8ROYGwT/+vX4XWec46dHOoG5+acO87FlsROw+f/gr3wXgD0aGC/nIENzuI1fjlwh9e2Pu417qfA+ob2uzGmTR6l8i7qLPfzvbvzeSjwqFMMcBh7pSfYK8b69DXGJBhjjjXGPOa1nOnu5TjLmoe9unLLbCTNA7E7120vNjD3a2QZTdpWscWgS8UWjxZhc119fZZ1wOtzGUf202BsYPU1FHuA7ffa7iexV8P++NvGgfVMW5/zgYW+RXwNGIT9XRGRJ+RIMezvmji/7z4fCjzhtb252CvkZGfcDJ/j4CJsju0oIvITEfnaKeI6DJxO3d8k1xjj8vru/k36Y49T77R571d/ao0xvYwxvZxl/Ad4t5FtbTIREexx8r7Xtn+HPWnVV/N+jztNzuttZzn9Ofo48f5PHjDGVHt9b+j4jAFyvdL0KHX/U95Oc9btrpj2MjBNRMZ4TZNrjKnwSZv3MezZh8aYQ9jci9/xHP1/cC/PXdTZ0PFR3za71fdfHgpc4XOMpgEDjTEF2PPWL4EDIvK2NL2C1EDsvin3ty31cN/yedY9QERGef1H8/zMcx9woc9v4usPwM3StCc+7nP+E8OxF4ve29vQf30gdX9rF/ai0ltzzh0fYPfDk8BBEflfEXH/ZrOx55F9TlF5mp/tGAjsM07kdRz1v/H67H1M1CuYzzlnYq9EvU8Q3YwxX7ZgOat8ltPdGHOj1zSmvpkdP1D3vuEQ7A/nHWwbW0ZD7nfmn2CMiQeuwJ7gmyITW0Tmb3gl9oLFvd3xxphx9SzH3zb+0MQ0uH0J/Bh7UXV5E6a/EFtEijHGu8LXn5q4Pt99nonNYfseM98441b4OQ5u8V2oiMRhg8A92OKrXsCnNO03OeCka7DXsCFN3B6MMaXYnNepXicA322twl7Ve1eu6V/PtDgnBXeO13v7Y4wx/k6y9aXNYLfP9zjxPvH5+03qOz5LgASf43NKPau/Cns+2iwiB7C3fgzwM69p+opXXQyOPoY9v4nY+9Xdsbc6/KXd9//gXl52E46P+ra5MZnYHK/3bxRnjHkEwBjznjHmRzgne5x7+n74/gY/AIki0s13WxpIy+PY//M77vmMMd97/Ud9Mw8YW8fkf7G3NfwnzJgN2FKG3zawbt959gC3A38TkShncEP/9f3YoAqA2HoMvhciTT53GOsvxpjJwARgInCzk7Y1xpjzsReVK4AlfjbhB44+BzS2/xsVzOD8BHCniIwDT8WEljzW9C4wSkSuFJFI5zVVRI5txjKWALeKyDDnhPknYJlpQW3uevTAnqgOO5UQft2MeZ8FFojIj8RWXBskImOMrVi0AvgfEYl3xo0QkZn1LGcJ8N8ikigifbGV4hY3d0OMMauwxTJPicjFvuOdyhXDRORv2Brdf2zuOhrwBHYb3JU1EkTkImfcm8BkEZnjHANRInK8+H+cqxu21CEHcIl9bOfUpiTAybm9A/xRbOWpCdgcT5M4weUKYK8xpqSedbiwlWvmOfvzx9h7qW4HgSSf4P4E8ICIDHbWk+TM11xLsKUjfUQkCXvfvaHj5BngehGZ4RyDg0VklHPC/Qp4UER6OONGisjJvgtwtuOn2Nsjk7xetwNXypFKZJHAH5zf9nRsceLrXou6QESmi0g0R+4p5tST7rexx8vFIhIhIj/DnlA/pPHjw+82N7CP3P4BXOL8l8Od4+dHItLf+V+fJ7a2cyX2fFFbz3IOAsOckg6wRcL/Ae4VW8lzCvZip6Enagy2aD8beNPZZ03xIHa/D29gmoXYouUm19w2xryDvXW0wBnU0H/9bWxp6blia2Lfhr0t0JB6l+ecJ9KcZZViL45rRSROROaKSDz2YrkY/7/J50CYiNziHEtnYOshterxxKAFZ2PMcuDPwFKxRb2bgHMansvvcoqxO2Iu9grmgLPcph5sAM8BL2Gv1vdg7980u9ZhA/6IrQxQiK2U8kZTZzTGfI09YB9x5l/FkSv+n2Erx2zB3ot/jXqKcbEnq3Tsn3gj8K0zrNmMMf/C3id7wSsAnCAiJdg/2GfYyhVTjTEbW7KOeta7BHvF/4ZzzKzHnihwigXPwu6r/dhj4V7sSdZ3OXnYE/872LoCs4H3m5GU67FX0gexRWHPNzJ9uDjFhU7aJnKkWLE+/w+7jwuwJRDexeAbsCeovU4xXW/sSfNj7NMExdhcUX251IbchT2eNmP377+dZftljPkceyL+X+zx+QlHcjWXYStgbcPe3liG/2Lti53xS4wxB9wv4CnscXS6M10GtkTrAPY/u8AYs9trOYux92PzsBVNr2og3Qexlb5+jz0G/h9wvjHmcGPHRyPbXC8nrRdhzwd52KLPm7Hn4XDgTmfb8rEVGus7By3FBr5DIvKlU+JxKfYJgAPY/fxrJ50NpceFvSA6DLzulWttaJ5D2HNRvcHQGLMdey7qVt809XgYuENEIhv5r+/HHluPYfdjMvacVtlAmupdHvYYfQG7H3Zjfxf3bdOrne+F2PPtUceUc8F+PvY4zsfWQZljjGno1kejpG4xuVJKdTxiHx983Bjj9z6siCwFNhljWnTBqUKXk+M9gG2HY02w0xMo2ra2UkqpkCIi5zi3QmOwxehlwDdBTlZAaXBWSikVamZgb0HmYNu7uNAYUxXcJAWWFmsrpZRSHYzmnJVSSqkOJiQbBG8JEXkOW6MuxxjjbpO7N7ZmYwq2JuilTq3fevXt29ekpKS0aVqVUqqz+eabb/KMMYnBTkeo6DLF2iIyA/vs4ItewflB4JAx5gGxXVAmGGMafHg+LS3NpKent32ClVKqExGRb4wx/lrYUn50mWJtY8xqnKYkvVyAbRgA572xZ0+VUkqpNtdlgnM9+jkPtLsfbPfbLrWIXCe2c/H03Nzcdk2gUkqprqerB+cmMcY8ZYxJM8akJSbqLROllFJtq8tUCKvHQREZYIzZLyIDsM/MNVt1dTVZWVlUVFQ0PrFSqk3FxMSQnJxMZORRLbcqFTK6enB+G9tW6gPO+1stWUhWVhY9evQgJSWFI23RK6XamzGG/Px8srKyGDZsWLCTo1SLdZlibRFZAqwBRotIlohcgw3KZ4jIDmwj6A+0ZNkVFRX06dNHA7NSQSYi9OnTR0uxVMjrMjlnY8xl9Yz6USCWr4FZqY5B/4uqM+gywVkppbqErG9g58cQ2c15xUJkjPPufI/w+t5jAIR1mULUkKHBuZPo3r07JSUlALz//vvcfPPNfPLJJzz33HM8/fTTJCYmUlpaSmpqKvfeey9jx46tM//GjRu58sorAdi3bx89e/akZ8+e9O3bl48//jjg6a2qqqJ///7813/9F/fcc0/Al99aV1xxBRdffDGzZ+uj7yqEGANv3gB53zd9nqEnwbzXICq27dKlmk2DcyfzySef8Itf/IIVK1YwZMgQAG699VZuv/12AJYtW8bpp5/Oxo0b8X4sLDU1lfXr1wMwf/58zj//fC6++OKjll9TU0NEROsPmw8//JCxY8eybNmygAXnQKVNqZCVtc4G5h8/CuMvhupyqC6Dmgr77v5eXW5fBXth5X3w6nyY+zKEaw33jkLLMjqRzz//nGuvvZb33nuPESNG+J1mzpw5nHnmmfzzn/9s8nI//vhjZs2axdy5c5k8eTIA//jHP5g2bRqTJk3ipptuwuVyAfDBBx9wwgknMGXKFObMmUNpaanfZS5ZsoTbbruNfv36sW7dOs/w5ORk7rjjDqZNm8b06dPZvXs3YHOyN954I6eccgqjRo3igw8+AOCZZ55h7ty5nH/++Zxzzjm4XC5uu+02xo8fT2pqKq+99hoARUVFnH766UyZMoUJEybw7rvvetb5/PPPM2HCBCZOnMiCBQs8w1euXMmJJ57I8OHDWb58eZP3l1JB891iiIyD8RdBdHfonggJQyFxNAycDENPhGNmwbE/hgmXwsxfw3n/Azs+grf+Hzj/YxV8ms0IsD++s5ktPxQFdJljB8az8MfjGpymsrKSCy64gM8++4wxY8Y0OO2UKVPYtm1bs9Lw1VdfsWXLFoYMGcKmTZtYvnw5X375JREREVx33XUsXbqUWbNm8cADD/DJJ58QGxvLfffdx6OPPsrvfve7OssqLS1l1apVPP/88xw4cIAlS5YwdepUz/iEhAS+/vprnnvuOW677TbefPNNADIzM1m1ahU7duxg1qxZ7Ny5E4A1a9awfv16EhISWLZsGVu2bGHDhg3k5uYydepUZsyYQUJCAm+99RY9evQgJyeHk046ifPPP58NGzbw5z//mS+//JLevXtz6NCRFl5zcnL497//zcaNG7n00ku58MILm7XPlGpXVaWw6Q0YdyFE92j6fFOvgbJ8m4OO6wtn3gtaqS7oNDh3EpGRkZx44ok8++yzPProow1O25LOTk444QRPMfnHH3/MunXrSEuzbdiXl5czePBgYmNj2bJlCyeeeCJg7yuffPLJRy3r7bff5owzziAmJoZLLrmEtLQ0Hn74YcKcSimXXWYr1s+bN4877rjDM9+ll15KWFgYo0ePZvDgwezYsQOAM888k4SEBAC++OILLr/8csLDw+nfvz8nn3wy6enpzJo1i9/+9rd88cUXhIWFkZmZSV5eHp9++ilz5syhd+/eAJ53gNmzZyMiTJgwgezs7GbvM6Xa1Za3oaoYJl/R/Hln/BpKc2HN4xCXCCffEvj0qWbR4BxgjeVw20pYWBivvPIKs2bN4k9/+tNRuVVv3333HWlpaaxdu5brr78egLvvvpuf/OQn9c4TFxfn+WyM4eqrrz7qXvHy5cs5++yzeemllxpM65IlS1i7di3urjdzcnJYvXo1p556KlD/ozC+w93ffdPmz4svvkhhYSHffvstERERJCcnU1FRgTGm3vVFR0c3ulylOozvFkPvETDk+ObPKwJn/9nmoD9eCLF9YMqVgU+jajK959yJxMbG8u677/Lyyy/z7LPP+p3m9ddfZ8WKFVx22WVMnz6d9evXs379+gYDs69Zs2bxyiuvkJeXB0B+fj779u3jxBNPZNWqVZ77xKWlpZ7crVtBQQFr164lKyuLjIwMMjIyeOyxx1iyZIlnmmXLlgE2iJ900kme4a+++irGGL7//nsyMzMZOXLkUWmbMWMGS5cupba2loMHD/Lvf/+btLQ0CgsLSUpKIiIign/961+enPCsWbNYunSppzjbu1hbqZCRvwv2fgGT57W8SDosDGY/ASNO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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# QUESTION 2: Main\n",
    "\n",
    "print(\"Working with 'rosenbrock'...\")\n",
    "\n",
    "# 1. Set up arrays for gathering runtime data.\n",
    "\n",
    "x_vals = np.arange(2,31)\n",
    "time_vals_tree = np.zeros(x_vals.size)\n",
    "time_vals_brute = np.zeros(x_vals.size)\n",
    "it = 0\n",
    "\n",
    "# 2. Iterate over d value and collect runtime data:\n",
    "\n",
    "for d_val in range(2,31):\n",
    "    print(\"Iteration {}\".format(it))\n",
    "    x_train, x_valid, x_test, y_train, y_valid, y_test = load_dataset('rosenbrock', n_train=5000, d=d_val)\n",
    "    start_tree = time.time()\n",
    "    knn_kdtree_regression(x_train, y_train, x_valid, y_valid, x_test, y_test, 5)\n",
    "    total_tree = time.time() - start_tree\n",
    "    start_brute = time.time()\n",
    "    test_k(x_train, y_train, x_valid, y_valid, x_test, y_test, 5, plot=False)\n",
    "    total_brute = time.time() - start_brute\n",
    "    time_vals_tree[it] = total_tree\n",
    "    time_vals_brute[it] = total_brute\n",
    "    it+=1\n",
    "    \n",
    "# 3. Plot runtime vs. d for KD approach, brute force approach\n",
    "\n",
    "plt.plot(x_vals, time_vals_tree, label = \"KD-Tree Approach\")\n",
    "plt.plot(x_vals, time_vals_brute, label = \"Brute Force Cross-Validation Approach\")\n",
    "plt.xlabel('Dimension Value (d)')\n",
    "# Set the y axis label of the current axis.\n",
    "plt.ylabel('Runtime (s)')\n",
    "# Set a title of the current axes.\n",
    "plt.title('Time Performance of KD-Tree and Brute Force Approaches to k-NN Regression')\n",
    "# show a legend on the plot\n",
    "plt.legend()\n",
    "# Display a figure.\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "# QUESTION 3: Functions\n",
    "\n",
    "# KD tree classification function\n",
    "# INPUT: All datasets (NxD np.arrays (X), Nx(# of classes) np.arrays (Y)), k (int), distance metric (str, 'L1' (2-norm) or 'L2' (1-norm)), whether to predict for validation data (True) or test data (bool)\n",
    "# OUTPUT: Loss for L1, L2 (floats)\n",
    "def knn_kdtree_classification(x_train, y_train, x_valid, y_valid, x_test, y_test, k_val, distance, valid=True):\n",
    "    start = time.time()\n",
    "    \n",
    "    if distance == 'L1':\n",
    "        metric_val = 'euclidean'\n",
    "    elif distance == 'L2':\n",
    "        metric_val = 'manhattan'\n",
    "    else:\n",
    "        return \"Invalid Distance Metric\"\n",
    "    \n",
    "    # Set up trees for train, valid, and test sets:\n",
    "    if valid:\n",
    "        tree_valid = KDTree(x_train,metric=metric_val)\n",
    "        pred_valid = np.zeros((y_valid.shape[0],y_valid.shape[1]))\n",
    "    else:\n",
    "        x_cross = np.vstack([x_valid,x_train])\n",
    "        y_cross = np.vstack([y_valid,y_train])\n",
    "        tree_test = KDTree(x_cross,metric=metric_val)\n",
    "        pred_test = np.zeros((y_test.shape[0],y_test.shape[1]))\n",
    "    \n",
    "    # Find accuracy for nearest neighbours:\n",
    "    if valid:\n",
    "        nearest_dist_valid, nearest_ind_valid = tree_valid.query(x_valid, k=k_val)\n",
    "        \n",
    "        it = 0\n",
    "        for inds1 in nearest_ind_valid:\n",
    "            neighbours = y_train[inds1]\n",
    "            for i in range(neighbours.shape[1]):\n",
    "                vote, count = np.unique(neighbours[:,i], return_counts=True)\n",
    "                pred_valid[it,i] = vote[np.argmax(count)]\n",
    "            it+=1\n",
    "            \n",
    "        pred_valid = pred_valid.astype(bool)\n",
    "        valid_accuracy = accuracy(y_valid,pred_valid)\n",
    "        \n",
    "    else:\n",
    "        nearest_dist_test, nearest_ind_test = tree_test.query(x_test, k=k_val)\n",
    "        \n",
    "        it = 0\n",
    "        for inds2 in nearest_ind_test:\n",
    "            neighbours = y_cross[inds2]\n",
    "            for i in range(neighbours.shape[1]):\n",
    "                vote, count = np.unique(neighbours[:,i], return_counts=True)\n",
    "                pred_test[it,i] = vote[np.argmax(count)]\n",
    "            it+=1\n",
    "            \n",
    "        pred_test = pred_test.astype(bool)\n",
    "        test_accuracy = accuracy(y_test,pred_test)\n",
    "    \n",
    "    # Print results\n",
    "    if valid:\n",
    "        print(\"Metric: {} | K-Value: {} | Accuracy for valid: {} | Time = {}s\".format(distance, k_val,valid_accuracy,(time.time()-start)))\n",
    "    else:\n",
    "        print(\"Metric: {} | K-Value: {} | Accuracy for test: {} | Time = {}s\".format(distance, k_val,test_accuracy,(time.time()-start)))\n",
    "    \n",
    "    # Return accuracy values\n",
    "    if valid:\n",
    "        return valid_accuracy\n",
    "    else:\n",
    "        return test_accuracy\n",
    "    \n",
    "# Accuracy Function\n",
    "# INPUT: Real Y array, predicted Y array (Nx(# of classes) np.arrays)\n",
    "# OUTPUT: Accuracy of results (float percentage)\n",
    "def accuracy(y_real,y_pred):\n",
    "    count = 0\n",
    "    for ind in range(y_real.shape[0]):\n",
    "        it = 1\n",
    "        for ind1 in range(y_real.shape[1]):\n",
    "            if y_real[ind,ind1] != y_pred[ind,ind1]:\n",
    "                it = 0\n",
    "        count+=it\n",
    "    return (count/(y_real.shape[0]))*100\n",
    "\n",
    "# Reshape MNIST data for plotting\n",
    "# INPUT: All X datasets (NxD np.arrays)\n",
    "# OUTPUT: New X datasets (NxD np.arrays)\n",
    "def reshape(x_train, x_valid, x_test):\n",
    "    x_train = np.reshape(x_train,(10000,28,28),order='C')\n",
    "    x_valid = np.reshape(x_valid,(1000,28,28),order='C')\n",
    "    x_test = np.reshape(x_test,(1000,28,28),order='C')\n",
    "    return x_train, x_valid, x_test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Working with 'mnist_small'...\n"
     ]
    },
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-6-bee10a280fa1>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[0;32m     16\u001b[0m \u001b[0mit\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;36m0\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     17\u001b[0m \u001b[1;32mfor\u001b[0m \u001b[0mk\u001b[0m \u001b[1;32min\u001b[0m \u001b[0mrange\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;36m2\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;36m30\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 18\u001b[1;33m     \u001b[0mvalid_acc1\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mit\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mknn_kdtree_classification\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mx_train\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_train\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mx_valid\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_valid\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mx_test\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_test\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mk\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m'L1'\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mvalid\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mTrue\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m     19\u001b[0m     \u001b[0mvalid_acc2\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mit\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mknn_kdtree_classification\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mx_train\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_train\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mx_valid\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_valid\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mx_test\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_test\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mk\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m'L2'\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mvalid\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mTrue\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     20\u001b[0m     \u001b[0mtest_acc1\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mit\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mknn_kdtree_classification\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mx_train\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_train\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mx_valid\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_valid\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mx_test\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_test\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mk\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m'L1'\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mvalid\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mFalse\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m<ipython-input-5-8b1f90ce806c>\u001b[0m in \u001b[0;36mknn_kdtree_classification\u001b[1;34m(x_train, y_train, x_valid, y_valid, x_test, y_test, k_val, distance, valid)\u001b[0m\n\u001b[0;32m     22\u001b[0m     \u001b[1;31m# Find accuracy for nearest neighbours:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     23\u001b[0m     \u001b[1;32mif\u001b[0m \u001b[0mvalid\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 24\u001b[1;33m         \u001b[0mnearest_dist_valid\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mnearest_ind_valid\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mtree_valid\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mquery\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mx_valid\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mk\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mk_val\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m     25\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     26\u001b[0m         \u001b[0mit\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;36m0\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "# QUESTION 3: Main\n",
    "\n",
    "# 1. Uncomment dataset you'd like to work with.\n",
    "\n",
    "#print(\"Working with 'iris'...\")\n",
    "#x_train, x_valid, x_test, y_train, y_valid, y_test = load_dataset('iris')\n",
    "\n",
    "print(\"Working with 'mnist_small'...\")\n",
    "x_train, x_valid, x_test, y_train, y_valid, y_test = load_dataset('mnist_small')\n",
    "#x_train, x_valid, x_test = reshape(x_train, x_valid, x_test)\n",
    "\n",
    "# 2. Set up arrays for accuracy data.\n",
    "\n",
    "x_vals = np.arange(2,30)\n",
    "test_acc1 = np.zeros(x_vals.size)\n",
    "valid_acc1 = np.zeros(x_vals.size)\n",
    "test_acc2 = np.zeros(x_vals.size)\n",
    "valid_acc2 = np.zeros(x_vals.size)\n",
    "\n",
    "# 3. Find k estimate by iterating through k.\n",
    "\n",
    "it = 0\n",
    "for k in range(2,30):\n",
    "    valid_acc1[it] = knn_kdtree_classification(x_train, y_train, x_valid, y_valid, x_test, y_test, k, 'L1', valid=True)\n",
    "    valid_acc2[it] = knn_kdtree_classification(x_train, y_train, x_valid, y_valid, x_test, y_test, k, 'L2', valid=True)\n",
    "    test_acc1[it] = knn_kdtree_classification(x_train, y_train, x_valid, y_valid, x_test, y_test, k, 'L1', valid=False)\n",
    "    test_acc2[it] = knn_kdtree_classification(x_train, y_train, x_valid, y_valid, x_test, y_test, k, 'L2', valid=False)\n",
    "    it+=1\n",
    "\n",
    "# 4. Plot accuracy for L1, L2   \n",
    "\n",
    "plt.plot(x_vals, valid_acc1, label = \"Valid Accuracy\")\n",
    "plt.plot(x_vals, test_acc1, label = \"Test Accuracy\")\n",
    "plt.xlabel('k-Value')\n",
    "# Set the y axis label of the current axis.\n",
    "plt.ylabel('Accuracy')\n",
    "# Set a title of the current axes.\n",
    "plt.title('Accuracy vs. K for L1')\n",
    "# show a legend on the plot\n",
    "plt.legend()\n",
    "# Display a figure.\n",
    "plt.show()\n",
    "\n",
    "plt.plot(x_vals, valid_acc2, label = \"Valid Accuracy\")\n",
    "plt.plot(x_vals, test_acc2, label = \"Test Accuracy\")\n",
    "plt.xlabel('k-Value')\n",
    "# Set the y axis label of the current axis.\n",
    "plt.ylabel('Accuracy')\n",
    "# Set a title of the current axes.\n",
    "plt.title('Accuracy vs. K for L2')\n",
    "# show a legend on the plot\n",
    "plt.legend()\n",
    "# Display a figure.\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "# QUESTION 4: Functions\n",
    "\n",
    "# SVD regression / classification function\n",
    "# INPUT: All datasets (NxD np.arrays (X), Nx(# of classes) np.arrays (Y)), regression/classification task (str: \"reg\", \"class\")\n",
    "# OUTPUT: Loss or accuracy (percent) for test predictions (float)\n",
    "def svd_regclass(x_train, x_valid, x_test, y_train, y_valid, y_test, task): \n",
    "    start = time.time()\n",
    "    \n",
    "    # Combine train and validation data\n",
    "    x_cross = np.vstack([x_valid,x_train])\n",
    "    y_cross = np.vstack([y_valid,y_train])\n",
    "    \n",
    "    # Compute SVD\n",
    "    x_svd = np.zeros((x_cross.shape[0],(x_cross.shape[1]+1)))\n",
    "    x_svd[:,0] = np.ones((x_cross.shape[0]))\n",
    "    x_svd[:,1:] = x_cross\n",
    "    u, s, vT = np.linalg.svd(x_svd)\n",
    "    \n",
    "    # Form sigma matrix from singular values\n",
    "    s1 = np.zeros((s.size,s.size))\n",
    "    np.fill_diagonal(s1,s)\n",
    "    \n",
    "    # Calculate weights\n",
    "    u1 = u[:,:s1.shape[0]]\n",
    "    weights = np.transpose(vT).dot(np.linalg.inv(s1)).dot(np.transpose(u1)).dot(y_cross)\n",
    "    \n",
    "    # Calculate test points:\n",
    "    X_test = np.zeros((x_test.shape[0],(x_test.shape[1]+1)))\n",
    "    X_test[:,0] = np.ones((x_test.shape[0]))\n",
    "    X_test[:,1:] = x_test\n",
    "    y_hat = np.dot(X_test,weights)\n",
    "    \n",
    "    # Calculate loss/accuracy\n",
    "    if task==\"reg\":\n",
    "        loss = RMSEloss(y_test,y_hat)\n",
    "    elif task==\"class\":\n",
    "        acc = accuracy2(y_test,y_hat)\n",
    "    else:\n",
    "        return print(\"Invalid Task\")\n",
    "    \n",
    "    # Return\n",
    "    if task==\"reg\":\n",
    "        print(\"Classification | Loss for test: {} | Time = {}s\".format(loss,(time.time()-start)))\n",
    "        return loss\n",
    "    else:\n",
    "        print(\"Classification | Accuracy for test: {} | Time = {}s\".format(acc,(time.time()-start)))\n",
    "        return acc\n",
    "\n",
    "# Accuracy Function\n",
    "# INPUT: Real Y array, predicted Y array (Nx(# of classes) np.arrays)\n",
    "# OUTPUT: Accuracy of results (float percentage)\n",
    "def accuracy2(y_real,y_pred):\n",
    "    count = 0\n",
    "    for line in range(y_real.shape[0]):\n",
    "        if np.argmax(y_real[line])==np.argmax(y_pred[line]):\n",
    "            count+=1\n",
    "    return (count/(y_real.shape[0]))*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Working with 'iris'...\n",
      "Classification | Accuracy for test: 86.66666666666667 | Time = 0.007703542709350586s\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "86.66666666666667"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# QUESTION 4: Main\n",
    "\n",
    "# 1. Uncomment the dataset you'd like to work with.\n",
    "\n",
    "#print(\"Working with 'mauna_loa'...\")\n",
    "#x_train, x_valid, x_test, y_train, y_valid, y_test = load_dataset('mauna_loa')\n",
    "\n",
    "#print(\"Working with 'rosenbrock'...\")\n",
    "#x_train, x_valid, x_test, y_train, y_valid, y_test = load_dataset('rosenbrock', n_train=1000, d=2)\n",
    "\n",
    "#print(\"Working with 'pumadyn32nm'...\")\n",
    "#x_train, x_valid, x_test, y_train, y_valid, y_test = load_dataset('pumadyn32nm')\n",
    "\n",
    "print(\"Working with 'iris'...\")\n",
    "x_train, x_valid, x_test, y_train, y_valid, y_test = load_dataset('iris')\n",
    "\n",
    "#print(\"Working with 'mnist_small'...\")\n",
    "#x_train, x_valid, x_test, y_train, y_valid, y_test = load_dataset('mnist_small')\n",
    "\n",
    "# 2. Run SVD function to get accuracy/loss\n",
    "\n",
    "svd_regclass(x_train, x_valid, x_test, y_train, y_valid, y_test, \"class\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
